# 어망 (Fish-Net) v0.68

> 비영리 커뮤니티 행정 과부하 해소를 위한 AI 에이전트 기반 역할 배정 및 교육 지원 솔루션

## 1. 문제 정의 (Problem Definition)

### 사회적 배경

지역사회 봉사 중심 비영리 단체(종교 단체, 지역아동센터 등)는 청소년 돌봄의 중추이나, 운영진의 반복 행정 과부하로 인해 정작 대상자와의 정서적 교감 시간이 부족합니다.

### 현장 페인 포인트 (실제 인터뷰 기반)

1. **비정형 응답 처리의 한계**: "이번 주만 늦어요", "시험 기간이라 힘들어요" 등 학생들의 다양한 상황을 매달 수동으로 취합하고 판단하는 데 상당한 시간이 소모됩니다.

2. **정보 전달의 공백**: 역할 배정 후 수행 가이드라인 및 당일 성가 정보가 제대로 전달되지 않아 당일 운영 차질이 생기고 이는 교사의 스트레스로 직결됩니다.

3. **당일 돌발 상황 대응의 어려움**: 미도착, 대타 요청, 학생끼리 사적으로 역할을 바꾸는 경우 교사가 모든 상황을 수동으로 파악하고 대응해야 합니다.

---

## 2. 핵심 해결 방안 (Solution)

### 한 줄 컨셉

> "교사는 링크만 공유하고 버튼만 딸깍. 배정, 교육, 성가 안내, 당일 대응까지 AI 에이전트가 전담하는 것이 목표"

### 전체 플로우

1. 교사가 이번 달 날짜 및 역할 설정
2. 학생 응답 수집 링크 공유
3. 학생이 가능 여부 및 코멘트 입력
4. AI가 조건 분석 후 월간 배정표 생성
5. 개별 카카오톡 메시지 초안 자동 생성
6. 교사 및 반주자가 이번 주 성가 확정 → 참석 학생 전원에게 성가 안내 메시지 자동 생성
7. 당일 돌발 상황 발생 시 대타 후보 자동 조회 및 변경 반영
8. RAG 챗봇이 역할별 가이드 질문에 실시간 답변

---

## 3. 주요 기능 상세 (Key Features)

| 구분 | 기능명 | 상세 내용 |
|------|--------|----------|
| Input | 스마트 가용성 분석 | 학생들이 입력한 텍스트 코멘트를 분석하여 배정 우선순위 및 제외 여부 자동 판단. (예: "시험 기간이라 힘들어요" → 가벼운 역할 우선 배정) |
| Process | 지능형 배정 엔진 | Claude API를 활용해 숙련도, 연속 배정 방지, 역할 쏠림 방지, 신입 배려, 1·2순위 백업 자동 지정, 배정 가능 인원 부족 시 사전 경고까지 고려한 월간 배정표 생성 |
| Output | 개인화 메시지 생성 | 배정 결과와 함께 학생별 상황에 맞춘 카카오톡 메시지 초안 자동 생성 |
| Special | 성가 안내 자동 발송 | 고정 성가(거룩하시도다, 하느님의 어린양 등)는 DB 기본값으로 저장. 사이사이 성가는 야훼이레 목록에서 교사가 선택 후 확정하면 당일 참석 학생 전원에게 성가 안내 메시지 초안 자동 생성 |
| Special | RAG 기반 교육 비서 | 교사가 업로드한 역할별 가이드 PDF를 기반으로 학생의 질문에 실시간 답변 제공 |
| 당일 대응 | 돌발 상황 대응 모듈 | 학생 불참 등록 시 대타 후보 자동 조회 및 교사 알림. 교사가 후보 선택 시 대타 요청 메시지 초안 자동 생성 |

### 교사 화면

- 이번 달 미사 날짜와 필요 역할(1독서, 2독서, 해설, 반주, 우리의 기도) 등록
- 학생 응답 수집 링크 생성 및 공유
- AI 배정 실행 후 월간 배정표 및 카카오톡 메시지 초안 확인·복사
- 미사 전 성가 확정 시 참석 학생에게 성가 안내 메시지 자동 생성
- 당일 백업 전환 버튼으로 후속 연락 즉시 자동 생성

### 학생 화면

- 링크 접속 후 본인 이름 선택 및 날짜별 가능 여부 체크 (가능 / 불가능 / 애매)
- 자유 코멘트 입력 (선택)
- 앱 내 역할 변경 요청: 대상 학생 선택 → 상대방 수락 시 배정표 자동 업데이트 및 교사 알림
- 배정 완료 후 RAG 챗봇에게 역할 수행 방법 질문 가능

### AI 배정 로직 (Claude API)

- 학생 코멘트 분석 후 배정 우선순위 판단
- 반주는 악기 가능자 우선 배정
- 연속 중복 및 역할 쏠림 방지
- 신입 학생은 가벼운 역할 우선 배정
- 1순위 백업 + 2순위 백업(백백업) 자동 지정
- 배정 가능 학생 부족 시 교사에게 사전 경고

### 성가 안내 메시지 예시

> "OO야, 이번 주 미사 성가 안내야! / 입당: 야훼이레 32번 / 거룩하시도다: 고정 / 화답송: 야훼이레 15번 / 하느님의 어린양: 고정 / 영성체: 야훼이레 57번 / 파견: 야훼이레 88번 준비해줘!"

---

## 4. 시스템 범위 및 한계

아래 상황은 의도적으로 교사 재량 영역으로 남겨둡니다. 

| 상황 | 시스템 대응 범위 |
|------|------------------|
| 당일 애매한 시간대 도착 (6시 40~50분) | 백업 전환 버튼까지만 지원. 이후 최종 판단은 교사 재량 |
| 학생끼리 카카오톡으로 사적 역할 변경 | 시스템 외부 변경은 막을 수 없음. 교사가 배정표를 수동 수정하는 기능 제공. 앱 내 변경 요청 UX를 카카오톡보다 편하게 만드는 것으로 대응 |
| 대타 체인이 계속 이어지는 경우 | 대타의 대타가 불참하는 최악의 경우는 교사가 최종 판단 |
| 무응답 학생 처리 | 응답 마감일까지 미응답 시 교사에게 알림 발송. 불참·가능 여부는 교사가 직접 확인 후 처리 |
| 성가 악보 제공 | 저작권 문제로 악보 PDF 전송은 지원하지 않음. 곡 번호와 제목 안내까지만 제공 |

---

## 5. 기술 스택 (Technical Stack)

| 구성 요소 | 선택 | 이유 |
|-----------|------|------|
| Framework | Next.js | 기존 학습 경험, 프론트·백엔드 통합 |
| 배포 | Vercel | Next.js 최적화, 자동 배포 |
| DB / 인증 | Firebase (Firestore + Auth) | 실시간성, 교사·학생 권한 분리, 50명+ 동시 접속 대응 |
| AI Engine | Claude API (API Routes) | 배정 로직 및 메시지 생성 |
| RAG | LangChain.js | JS 생태계 통합, 기술적 깊이 어필 |
| 성가 DB | Firestore 컬렉션 | 고정 성가 기본값 + 야훼이레 목록 관리 |

### 프로젝트 구조

```
fish-net/
├── src/
│   ├── app/
│   │   ├── page.tsx              # 메인 페이지
│   │   ├── teacher/page.tsx      # 교사 화면
│   │   ├── student/page.tsx      # 학생 화면
│   │   └── api/
│   │       ├── schedule/route.ts # 배정 로직 (Claude API)
│   │       ├── message/route.ts  # 메시지 생성
│   │       └── rag/route.ts      # RAG 챗봇
│   ├── lib/
│   │   ├── firebase.ts           # Firebase 초기화
│   │   └── langchain.ts          # LangChain RAG 설정
│   └── types/
│       └── index.ts              # TypeScript 타입 정의
└── vercel.json
```

---

## 6. 기대 효과 (Impact)

### 정량적 효과

교사의 월간 행정 업무 시간 유의미하게 단축 (추후 실사용 데이터로 검증 예정)

### 정성적 효과

- 학생이 직접 일정을 입력하고 역할 변경을 요청하는 구조로 **참여 책임감 강화**
- 성가 안내 자동화로 **당일 준비 미흡 문제 감소**
- RAG 가이드를 통해 **역할 수행 자신감 향상**
- 전체 운영 퀄리티 상향

### 확장성

Firebase 기반으로 50명 이상 동시 접속 대응 가능. 지역아동센터, 방과후학교 등 봉사자 기반 스케줄링이 필요한 비영리 단체 전반으로 확산 가능합니다.

---

## 7. 향후 확장 계획

- n8n을 활용한 미응답자 자동 리마인드 워크플로우
- 출석 기반 은총 포인트 시스템
- 가톨릭 굿뉴스 주보 연동 자동 성가 추천
- 카카오 비즈니스 API 연동을 통한 메시지 자동 발송

---

## 8. 변경 이력

### v0.6 → v0.68

- 프로젝트명 홀리 커넥트 → **어망 (Fish-Net)**으로 변경
- 기술 스택 전면 교체: Streamlit → **Next.js + Vercel + Firebase**
- DB Google Sheets → **Firestore**로 변경 (실시간성 및 인증 통합)
- RAG **LangChain.js** 도입 (Python → JS 생태계 통일)
- 교사·학생 권한 분리 (Firebase Auth) 명시
- 프로젝트 폴더 구조 추가

### v0.5 → v0.6

- 기술 스택을 MVP 단계와 상용화 단계로 분리
- Framework: FastAPI + HTML → Streamlit (개발 속도 우선)
- Deployment: Vercel → Streamlit Cloud (MVP) / Cloud Run (상용화)
- Database: Google Sheets 유지 (MVP) / Supabase 마이그레이션 (상용화)
- AI Engine: LangChain 추가 (RAG 정확도 향상)
- 확장성 섹션 신설 (50명 이상 상용화 대응 방안 명시)
- Streamlit Cloud 슬립 모드 주의사항 명시

### v0.4 → v0.5

- 성가 안내 자동 발송 기능 추가 (고정 성가 DB + 야훼이레 목록 선택 → 참석 학생 메시지 자동 생성)
- 성가 악보 저작권 한계 명시
- 배포 플랫폼 Streamlit Cloud → Vercel로 변경 (FastAPI + HTML 구조)
- 기술 스택 표로 정리
- 향후 확장 계획에 가톨릭 굿뉴스 주보 연동 성가 추천 추가

### v0.35 → v0.4

- 당일 돌발 상황 대응 모듈 추가 (백업 전환 버튼, 대타 후보 자동 조회)
- 학생 간 역할 변경 요청 기능 추가 (앱 내 변경 → 배정표 자동 업데이트)
- 배정 로직 고도화 (역할 쏠림 방지, 신입 배려, 백백업, 사전 경고)
- 시스템 범위 및 한계 섹션 신설 (의도적 교사 재량 영역 명시)
- 무응답 처리 정책 명시

---

## 라이선스

이 프로젝트는 비영리 커뮤니티를 위해 개발되었습니다.

---

© 2026 어망 (Fish-Net) · 병점 성당 중고등부 주일학교
