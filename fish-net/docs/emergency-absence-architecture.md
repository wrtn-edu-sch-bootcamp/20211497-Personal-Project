# ê¸´ê¸‰ ë¶ˆì°¸ ì‹ ê³  ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

## ì‹œìŠ¤í…œ êµ¬ì„±ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         í•™ìƒ ì›¹ ì¸í„°í˜ì´ìŠ¤                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  ë‚´ ì—­í•  ë°°ì • í™•ì¸ í˜ì´ì§€                                   â”‚      â”‚
â”‚  â”‚  /student/schedule                                          â”‚      â”‚
â”‚  â”‚                                                              â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚      â”‚
â”‚  â”‚  â”‚  ì •ë°°ì • ì—­í•  ì¹´ë“œ                         â”‚              â”‚      â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚              â”‚      â”‚
â”‚  â”‚  â”‚  â”‚  ğŸ“– 1ë…ì„œ                       â”‚      â”‚              â”‚      â”‚
â”‚  â”‚  â”‚  â”‚  2026ë…„ 3ì›” 1ì¼ (í† )            â”‚      â”‚              â”‚      â”‚
â”‚  â”‚  â”‚  â”‚                                 â”‚      â”‚              â”‚      â”‚
â”‚  â”‚  â”‚  â”‚  [ğŸš¨ ê¸´ê¸‰ ë¶ˆì°¸ ì‹ ê³ ]  â† í´ë¦­   â”‚      â”‚              â”‚      â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚              â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ 1. ë¶ˆì°¸ ì‚¬ìœ  ì…ë ¥ ëª¨ë‹¬ í‘œì‹œ
                         â”‚ 2. POST /api/emergency
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ë°±ì—”ë“œ API ì„œë²„                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  /api/emergency/route.ts                                    â”‚      â”‚
â”‚  â”‚                                                              â”‚      â”‚
â”‚  â”‚  1. ìš”ì²­ ê²€ì¦                                                â”‚      â”‚
â”‚  â”‚  2. Firestore ì—…ë°ì´íŠ¸                                       â”‚      â”‚
â”‚  â”‚  3. n8n Webhook í˜¸ì¶œ                                         â”‚      â”‚
â”‚  â”‚  4. ì‘ë‹µ ë°˜í™˜                                                â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                               â”‚
                â”‚                               â”‚
                â†“                               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Firestore Database       â”‚   â”‚      n8n Automation          â”‚
â”‚                               â”‚   â”‚                              â”‚
â”‚  assignments ì»¬ë ‰ì…˜           â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚  â”‚  Webhook ë…¸ë“œ          â”‚ â”‚
â”‚  â”‚ {                       â”‚ â”‚   â”‚  â”‚  (POST ìˆ˜ì‹ )           â”‚ â”‚
â”‚  â”‚   status: "absent",     â”‚ â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚   absentReason: "...",  â”‚ â”‚   â”‚             â”‚               â”‚
â”‚  â”‚   absentReportedAt: ... â”‚ â”‚   â”‚             â†“               â”‚
â”‚  â”‚ }                       â”‚ â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚  â”‚  ì´ë©”ì¼ ë°œì†¡ ë…¸ë“œ      â”‚ â”‚
â”‚                               â”‚   â”‚  â”‚  (Resend/Gmail)        â”‚ â”‚
â”‚         â”‚ onSnapshot          â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚ (ì‹¤ì‹œê°„ ê°ì§€)        â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚         â”‚                     â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
          â”‚                                       â”‚
          â”‚                                       â†“
          â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                          â”‚   êµì‚¬ ì´ë©”ì¼ ìˆ˜ì‹         â”‚
          â”‚                          â”‚                          â”‚
          â”‚                          â”‚   ğŸš¨ ê¸´ê¸‰ ë¶ˆì°¸ ë°œìƒ!     â”‚
          â”‚                          â”‚   í•™ìƒ: í™ê¸¸ë™ (ìš”ì…‰)    â”‚
          â”‚                          â”‚   ë‚ ì§œ: 2026-03-01       â”‚
          â”‚                          â”‚   ì—­í• : 1ë…ì„œ            â”‚
          â”‚                          â”‚   ì‚¬ìœ : ê°€ì¡± í–‰ì‚¬        â”‚
          â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      êµì‚¬ ì›¹ ëŒ€ì‹œë³´ë“œ                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  /teacher                                                   â”‚      â”‚
â”‚  â”‚                                                              â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚      â”‚
â”‚  â”‚  â”‚  ğŸš¨ ê¸´ê¸‰ ë¶ˆì°¸ ë°œìƒ! (ì‹¤ì‹œê°„ ì•Œë¦¼ ë°°ë„ˆ)             â”‚    â”‚      â”‚
â”‚  â”‚  â”‚                                                     â”‚    â”‚      â”‚
â”‚  â”‚  â”‚  í™ê¸¸ë™ (ìš”ì…‰) Â· 2026-03-01 Â· 1ë…ì„œ               â”‚    â”‚      â”‚
â”‚  â”‚  â”‚  ì‚¬ìœ : ê°‘ì‘ìŠ¤ëŸ¬ìš´ ê°€ì¡± í–‰ì‚¬                        â”‚    â”‚      â”‚
â”‚  â”‚  â”‚  ì‹ ê³  ì‹œê°: 2026-02-26 10:30                       â”‚    â”‚      â”‚
â”‚  â”‚  â”‚                                                     â”‚    â”‚      â”‚
â”‚  â”‚  â”‚  ğŸ‘‡ ì•„ë˜ 'ë‹¹ì¼ ëŒ€ì‘' ì„¹ì…˜ì—ì„œ ëŒ€íƒ€ í›„ë³´ ì¡°íšŒ      â”‚    â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚      â”‚
â”‚  â”‚                                                              â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚      â”‚
â”‚  â”‚  â”‚  3. ë‹¹ì¼ ëŒ€ì‘ (ë¶ˆì°¸/ëŒ€íƒ€)                          â”‚    â”‚      â”‚
â”‚  â”‚  â”‚                                                     â”‚    â”‚      â”‚
â”‚  â”‚  â”‚  ë‚ ì§œ ì„ íƒ: [2026-03-01 â–¼]                         â”‚    â”‚      â”‚
â”‚  â”‚  â”‚  ë¶ˆì°¸ í•™ìƒ: [í™ê¸¸ë™ (ìš”ì…‰) â€” 1ë…ì„œ â–¼]             â”‚    â”‚      â”‚
â”‚  â”‚  â”‚                                                     â”‚    â”‚      â”‚
â”‚  â”‚  â”‚  [ëŒ€íƒ€ í›„ë³´ ì¡°íšŒ]                                  â”‚    â”‚      â”‚
â”‚  â”‚  â”‚                                                     â”‚    â”‚      â”‚
â”‚  â”‚  â”‚  ëŒ€íƒ€ í›„ë³´:                                         â”‚    â”‚      â”‚
â”‚  â”‚  â”‚  â€¢ ê¹€ì² ìˆ˜ (1ìˆœìœ„ ë°±ì—…)                             â”‚    â”‚      â”‚
â”‚  â”‚  â”‚  â€¢ ì´ì˜í¬ (2ìˆœìœ„ ë°±ì—…)                             â”‚    â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ë°ì´í„° íë¦„ ì‹œí€€ìŠ¤

```
í•™ìƒ                API                Firestore           n8n              êµì‚¬
 â”‚                  â”‚                    â”‚                 â”‚                â”‚
 â”‚ 1. ë¶ˆì°¸ ì‹ ê³      â”‚                    â”‚                 â”‚                â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                 â”‚                â”‚
 â”‚                  â”‚                    â”‚                 â”‚                â”‚
 â”‚                  â”‚ 2. ë°°ì • ì¡°íšŒ       â”‚                 â”‚                â”‚
 â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚                â”‚
 â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚                â”‚
 â”‚                  â”‚                    â”‚                 â”‚                â”‚
 â”‚                  â”‚ 3. ìƒíƒœ ì—…ë°ì´íŠ¸   â”‚                 â”‚                â”‚
 â”‚                  â”‚    (status: absent)â”‚                 â”‚                â”‚
 â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚                â”‚
 â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚                â”‚
 â”‚                  â”‚                    â”‚                 â”‚                â”‚
 â”‚                  â”‚ 4. Webhook í˜¸ì¶œ    â”‚                 â”‚                â”‚
 â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
 â”‚                  â”‚                    â”‚                 â”‚                â”‚
 â”‚                  â”‚                    â”‚                 â”‚ 5. ì´ë©”ì¼ ë°œì†¡ â”‚
 â”‚                  â”‚                    â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                  â”‚                    â”‚                 â”‚                â”‚
 â”‚ 6. ì„±ê³µ ì‘ë‹µ     â”‚                    â”‚                 â”‚                â”‚
 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                 â”‚                â”‚
 â”‚                  â”‚                    â”‚                 â”‚                â”‚
 â”‚                  â”‚                    â”‚ 7. onSnapshot   â”‚                â”‚
 â”‚                  â”‚                    â”‚    (ì‹¤ì‹œê°„ ê°ì§€) â”‚                â”‚
 â”‚                  â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                  â”‚                    â”‚                 â”‚                â”‚
 â”‚                  â”‚                    â”‚                 â”‚ 8. ì•Œë¦¼ ë°°ë„ˆ   â”‚
 â”‚                  â”‚                    â”‚                 â”‚    ìë™ í‘œì‹œ   â”‚
 â”‚                  â”‚                    â”‚                 â”‚                â”‚
```

## ì»´í¬ë„ŒíŠ¸ ìƒí˜¸ì‘ìš©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  í•™ìƒ í˜ì´ì§€ (schedule/page.tsx)                                â”‚
â”‚                                                                  â”‚
â”‚  State:                                                          â”‚
â”‚  - emergencyModal: { isOpen, record, reason, isSubmitting }     â”‚
â”‚                                                                  â”‚
â”‚  Functions:                                                      â”‚
â”‚  - handleOpenEmergencyModal(record)                             â”‚
â”‚  - handleCloseEmergencyModal()                                  â”‚
â”‚  - handleSubmitEmergency()                                      â”‚
â”‚                                                                  â”‚
â”‚  Components:                                                     â”‚
â”‚  - AssignmentCard (with onEmergencyReport prop)                 â”‚
â”‚  - Emergency Modal (conditional render)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ API Call
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Emergency API (api/emergency/route.ts)                         â”‚
â”‚                                                                  â”‚
â”‚  Steps:                                                          â”‚
â”‚  1. Validate request body                                       â”‚
â”‚  2. Query Firestore for assignment                              â”‚
â”‚  3. Update assignment status to 'absent'                        â”‚
â”‚  4. Call n8n webhook (if configured)                            â”‚
â”‚  5. Return success response                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  êµì‚¬ ëŒ€ì‹œë³´ë“œ (teacher/page.tsx)                                â”‚
â”‚                                                                  â”‚
â”‚  State:                                                          â”‚
â”‚  - emergencyAbsences: Array<{...}>                              â”‚
â”‚                                                                  â”‚
â”‚  Effects:                                                        â”‚
â”‚  - useEffect(() => {                                            â”‚
â”‚      const unsubscribe = onSnapshot(                            â”‚
â”‚        query(assignments, where("status", "==", "absent")),     â”‚
â”‚        (snapshot) => { /* update state */ }                     â”‚
â”‚      );                                                          â”‚
â”‚      return unsubscribe;                                        â”‚
â”‚    }, [massDates, students]);                                   â”‚
â”‚                                                                  â”‚
â”‚  Components:                                                     â”‚
â”‚  - Emergency Alert Banner (conditional render)                  â”‚
â”‚  - ë‹¹ì¼ ëŒ€ì‘ ì„¹ì…˜ (with emergency notice)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## íŒŒì¼ êµ¬ì¡°

```
fish-net/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â””â”€â”€ emergency/
â”‚   â”‚   â”‚       â””â”€â”€ route.ts          â† ìƒˆë¡œ ìƒì„±
â”‚   â”‚   â”œâ”€â”€ student/
â”‚   â”‚   â”‚   â””â”€â”€ schedule/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx          â† ìˆ˜ì • (ê¸´ê¸‰ ë¶ˆì°¸ ë²„íŠ¼ ì¶”ê°€)
â”‚   â”‚   â””â”€â”€ teacher/
â”‚   â”‚       â””â”€â”€ page.tsx              â† ìˆ˜ì • (ì‹¤ì‹œê°„ ì•Œë¦¼ ì¶”ê°€)
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ index.ts                  â† ìˆ˜ì • (Assignment íƒ€ì… í™•ì¥)
â”‚   â””â”€â”€ lib/
â”‚       â”œâ”€â”€ firebase.ts
â”‚       â””â”€â”€ firestore.ts
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ emergency-absence-feature.md       â† ìƒˆë¡œ ìƒì„±
â”‚   â”œâ”€â”€ emergency-absence-architecture.md  â† ìƒˆë¡œ ìƒì„±
â”‚   â””â”€â”€ n8n-emergency-workflow.md          â† ìƒˆë¡œ ìƒì„±
â””â”€â”€ .env.example                            â† ìˆ˜ì • (N8N_WEBHOOK_URL ì¶”ê°€)
```

## ê¸°ìˆ  ìŠ¤íƒ

### í”„ë¡ íŠ¸ì—”ë“œ
- **Framework**: Next.js 14 (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **State Management**: React useState, useEffect

### ë°±ì—”ë“œ
- **Runtime**: Next.js API Routes
- **Database**: Firebase Firestore
- **Real-time**: Firestore onSnapshot
- **Automation**: n8n Webhook

### í†µì‹ 
- **Client â†’ API**: REST (fetch)
- **API â†’ Firestore**: Firebase SDK
- **API â†’ n8n**: HTTP POST
- **Firestore â†’ Client**: WebSocket (onSnapshot)

## ë³´ì•ˆ ê³„ì¸µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. í´ë¼ì´ì–¸íŠ¸ ê²€ì¦                                          â”‚
â”‚     - í•„ìˆ˜ í•„ë“œ ì…ë ¥ í™•ì¸                                    â”‚
â”‚     - ì‚¬ìœ  ìµœì†Œ ê¸¸ì´ ê²€ì¦                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. API ê²€ì¦                                                 â”‚
â”‚     - Request body validation                                â”‚
â”‚     - Student/Assignment existence check                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Firestore Rules                                          â”‚
â”‚     - Read/Write permissions                                 â”‚
â”‚     - (í˜„ì¬: ëª¨ë‘ í—ˆìš©, ì¶”í›„ ì¸ì¦ ê¸°ë°˜ ì œí•œ ê¶Œì¥)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. n8n Webhook                                              â”‚
â”‚     - (ê¶Œì¥) Bearer Token ì¸ì¦                               â”‚
â”‚     - (ê¶Œì¥) IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ì„±ëŠ¥ ìµœì í™”

### 1. ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
- Firestore `onSnapshot`ì„ ì‚¬ìš©í•˜ì—¬ í´ë§ ì—†ì´ ì‹¤ì‹œê°„ ê°ì§€
- ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€ë¥¼ ìœ„í•œ ì˜ì¡´ì„± ë°°ì—´ ìµœì í™”

### 2. API ì‘ë‹µ ì†ë„
- Firestore ì¿¼ë¦¬ ìµœì í™” (ì¸ë±ìŠ¤ í™œìš©)
- Webhook í˜¸ì¶œì€ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬ (ì‹¤íŒ¨í•´ë„ Firestore ì—…ë°ì´íŠ¸ëŠ” ì„±ê³µ)

### 3. í´ë¼ì´ì–¸íŠ¸ ì„±ëŠ¥
- ëª¨ë‹¬ ì¡°ê±´ë¶€ ë Œë”ë§ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ DOM ìƒì„± ë°©ì§€
- ì œì¶œ ì¤‘ ë²„íŠ¼ ë¹„í™œì„±í™”ë¡œ ì¤‘ë³µ ìš”ì²­ ë°©ì§€

## ì—ëŸ¬ í•¸ë“¤ë§ ì „ëµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Level 1: í´ë¼ì´ì–¸íŠ¸                                         â”‚
â”‚  - ì‚¬ìš©ì ì¹œí™”ì  ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ                            â”‚
â”‚  - ì¬ì‹œë„ ê°€ëŠ¥í•œ UI ì œê³µ                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Level 2: API                                                â”‚
â”‚  - try-catchë¡œ ëª¨ë“  ì˜ˆì™¸ í¬ì°©                                â”‚
â”‚  - ìƒì„¸í•œ ì—ëŸ¬ ë¡œê·¸ ê¸°ë¡                                     â”‚
â”‚  - ì ì ˆí•œ HTTP ìƒíƒœ ì½”ë“œ ë°˜í™˜                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Level 3: Webhook                                            â”‚
â”‚  - Webhook ì‹¤íŒ¨ ì‹œì—ë„ Firestore ì—…ë°ì´íŠ¸ëŠ” ì„±ê³µ            â”‚
â”‚  - ì‹¤íŒ¨ ë¡œê·¸ ê¸°ë¡ (ì¶”í›„ ì¬ì „ì†¡ ê°€ëŠ¥)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**ë¬¸ì„œ ë²„ì „**: 1.0.0  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2026ë…„ 2ì›” 26ì¼
